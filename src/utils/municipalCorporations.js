// Municipal Corporation mapping with 6-digit codes
export const municipalCorporations = [
  { name: 'Abohar Municipal Corporation', code: '100001' },
  { name: 'Adityapur Municipal Corporation', code: '100002' },
  { name: 'Agartala Municipal Corporation', code: '100003' },
  { name: 'Agra Municipal Corporation', code: '100004' },
  { name: 'Ahmedabad Municipal Corporation', code: '100005' },
  { name: 'Ahmednagar Municipal Corporation', code: '100006' },
  { name: 'Aizawl Municipal Corporation', code: '100007' },
  { name: 'Ajmer Municipal Corporation', code: '100008' },
  { name: 'Akola Municipal Corporation', code: '100009' },
  { name: 'Aligarh Municipal Corporation', code: '100010' },
  { name: 'Alwar Municipal Corporation', code: '100011' },
  { name: 'Ambala Municipal Corporation', code: '100012' },
  { name: 'Ambikapur Municipal Corporation', code: '100013' },
  { name: 'Amravati Municipal Corporation', code: '100014' },
  { name: 'Amritsar Municipal Corporation', code: '100015' },
  { name: 'Anantapur Municipal Corporation', code: '100016' },
  { name: 'Anuppur Nagar Nigam', code: '100017' },
  { name: 'Arrah Municipal Corporation', code: '100018' },
  { name: 'Asansol Municipal Corporation', code: '100019' },
  { name: 'Ashoknagar Nagar Nigam', code: '100020' },
  { name: 'Aurangabad Municipal Corporation', code: '100021' },
  { name: 'Avadi Municipal Corporation', code: '100022' },
  { name: 'Ayodhya Municipal Corporation', code: '100023' },
  { name: 'Badangpet Municipal Corporation', code: '100024' },
  { name: 'Baddi Municipal Corporation', code: '100025' },
  { name: 'Ballari Municipal Corporation', code: '100026' },
  { name: 'Bandlaguda Jagir Municipal Corporation', code: '100027' },
  { name: 'Bareilly Municipal Corporation', code: '100028' },
  { name: 'Batala Municipal Corporation', code: '100029' },
  { name: 'Bathinda Municipal Corporation', code: '100030' },
  { name: 'Begusarai Municipal Corporation', code: '100031' },
  { name: 'Belagavi Municipal Corporation', code: '100032' },
  { name: 'Berhampur Municipal Corporation', code: '100033' },
  { name: 'Betul Nagar Nigam', code: '100034' },
  { name: 'Bhagalpur Municipal Corporation', code: '100035' },
  { name: 'Bharatpur Municipal Corporation', code: '100036' },
  { name: 'Bhavnagar Municipal Corporation', code: '100037' },
  { name: 'Bhilai Charoda Municipal Corporation', code: '100038' },
  { name: 'Bhilai Municipal Corporation', code: '100039' },
  { name: 'Bhind Nagar Nigam', code: '100040' },
  { name: 'Bhiwandi-Nizampur Municipal Corporation', code: '100041' },
  { name: 'Bhopal Nagar Nigam', code: '100042' },
  { name: 'Bhubaneswar Municipal Corporation', code: '100043' },
  { name: 'Bidhannagar Municipal Corporation', code: '100044' },
  { name: 'Bihar Sharif Municipal Corporation', code: '100045' },
  { name: 'Bikaner Municipal Corporation', code: '100046' },
  { name: 'Birgaon Municipal Corporation', code: '100047' },
  { name: 'Boduppal Municipal Corporation', code: '100048' },
  { name: 'Brihanmumbai Municipal Corporation', code: '100049' },
  { name: 'Bruhat Bengaluru Mahanagara Palike (BBMP)', code: '100050' },
  { name: 'Burhanpur Nagar Nigam', code: '100051' },
  { name: 'Chandernagore Municipal Corporation', code: '100052' },
  { name: 'Chandigarh Municipal Corporation', code: '100053' },
  { name: 'Chandrapur City Municipal Corporation', code: '100054' },
  { name: 'Chas Municipal Corporation', code: '100055' },
  { name: 'Chhindwara Nagar Nigam', code: '100056' },
  { name: 'Chirmiri Municipal Corporation', code: '100057' },
  { name: 'Chittoor Municipal Corporation', code: '100058' },
  { name: 'Coimbatore Municipal Corporation', code: '100059' },
  { name: 'Corporation of the City of Panaji', code: '100060' },
  { name: 'Cuddalore Municipal Corporation', code: '100061' },
  { name: 'Cuttack Municipal Corporation', code: '100062' },
  { name: 'Darbhanga Municipal Corporation', code: '100063' },
  { name: 'Datia Nagar Nigam', code: '100064' },
  { name: 'Davangere Municipal Corporation', code: '100065' },
  { name: 'Dehradun Municipal Corporation', code: '100066' },
  { name: 'Deoghar Municipal Corporation', code: '100067' },
  { name: 'Dewas Nagar Nigam', code: '100068' },
  { name: 'Dhamtari Municipal Corporation', code: '100069' },
  { name: 'Dharamshala Municipal Corporation', code: '100070' },
  { name: 'Dhule Municipal Corporation', code: '100071' },
  { name: 'Dimapur Municipal Council', code: '100072' },
  { name: 'Dindigul Municipal Corporation', code: '100073' },
  { name: 'Durg Municipal Corporation', code: '100074' },
  { name: 'Durgapur Municipal Corporation', code: '100075' },
  { name: 'Eluru Municipal Corporation', code: '100076' },
  { name: 'Erode Municipal Corporation', code: '100077' },
  { name: 'Faridabad Municipal Corporation', code: '100078' },
  { name: 'Firozabad Municipal Corporation', code: '100079' },
  { name: 'Gandhinagar Municipal Corporation', code: '100080' },
  { name: 'Gangtok Municipal Corporation', code: '100081' },
  { name: 'Gaya Municipal Corporation', code: '100082' },
  { name: 'Ghaziabad Municipal Corporation', code: '100083' },
  { name: 'Giridih Municipal Corporation', code: '100084' },
  { name: 'Gorakhpur Municipal Corporation', code: '100085' },
  { name: 'Greater Chennai Corporation', code: '100086' },
  { name: 'Greater Hyderabad Municipal Corporation (GHMC)', code: '100087' },
  { name: 'Greater Mumbai Municipal Corporation', code: '100088' },
  { name: 'Greater Noida Municipal Corporation', code: '100089' },
  { name: 'Gurugram Municipal Corporation', code: '100090' },
  { name: 'Guwahati Municipal Corporation', code: '100091' },
  { name: 'Gwalior Municipal Corporation', code: '100092' },
  { name: 'Haldia Municipal Corporation', code: '100093' },
  { name: 'Haridwar Municipal Corporation', code: '100094' },
  { name: 'Hazaribagh Municipal Corporation', code: '100095' },
  { name: 'Hospet Municipal Corporation', code: '100096' },
  { name: 'Hubli-Dharwad Municipal Corporation', code: '100097' },
  { name: 'Hyderabad Municipal Corporation', code: '100098' },
  { name: 'Indore Municipal Corporation', code: '100099' },
  { name: 'Jabalpur Municipal Corporation', code: '100100' },
  { name: 'Jaipur Municipal Corporation', code: '100101' },
  { name: 'Jalandhar Municipal Corporation', code: '100102' },
  { name: 'Jalgaon Municipal Corporation', code: '100103' },
  { name: 'Jammu Municipal Corporation', code: '100104' },
  { name: 'Jamnagar Municipal Corporation', code: '100105' },
  { name: 'Jamshedpur Municipal Corporation', code: '100106' },
  { name: 'Jhansi Municipal Corporation', code: '100107' },
  { name: 'Jodhpur Municipal Corporation', code: '100108' },
  { name: 'Kakinada Municipal Corporation', code: '100109' },
  { name: 'Kalyan-Dombivli Municipal Corporation', code: '100110' },
  { name: 'Kanpur Municipal Corporation', code: '100111' },
  { name: 'Karnal Municipal Corporation', code: '100112' },
  { name: 'Kochi Municipal Corporation', code: '100113' },
  { name: 'Kolhapur Municipal Corporation', code: '100114' },
  { name: 'Kolkata Municipal Corporation', code: '100115' },
  { name: 'Kollam Municipal Corporation', code: '100116' },
  { name: 'Kozhikode Municipal Corporation', code: '100117' },
  { name: 'Kurnool Municipal Corporation', code: '100118' },
  { name: 'Lucknow Municipal Corporation', code: '100119' },
  { name: 'Ludhiana Municipal Corporation', code: '100120' },
  { name: 'Madurai Municipal Corporation', code: '100121' },
  { name: 'Mangalore Municipal Corporation', code: '100122' },
  { name: 'Meerut Municipal Corporation', code: '100123' },
  { name: 'Mira-Bhayandar Municipal Corporation', code: '100124' },
  { name: 'Mysore Municipal Corporation', code: '100125' },
  { name: 'Nagpur Municipal Corporation', code: '100126' },
  { name: 'Nashik Municipal Corporation', code: '100127' },
  { name: 'Navi Mumbai Municipal Corporation', code: '100128' },
  { name: 'Nellore Municipal Corporation', code: '100129' },
  { name: 'Noida Municipal Corporation', code: '100130' },
  { name: 'Patna Municipal Corporation', code: '100131' },
  { name: 'Pimpri-Chinchwad Municipal Corporation', code: '100132' },
  { name: 'Pune Municipal Corporation', code: '100133' },
  { name: 'Puri Municipal Corporation', code: '100134' },
  { name: 'Raipur Municipal Corporation', code: '100135' },
  { name: 'Rajkot Municipal Corporation', code: '100136' },
  { name: 'Ranchi Municipal Corporation', code: '100137' },
  { name: 'Salem Municipal Corporation', code: '100138' },
  { name: 'Shimla Municipal Corporation', code: '100139' },
  { name: 'Siliguri Municipal Corporation', code: '100140' },
  { name: 'Solapur Municipal Corporation', code: '100141' },
  { name: 'Srinagar Municipal Corporation', code: '100142' },
  { name: 'Surat Municipal Corporation', code: '100143' },
  { name: 'Thane Municipal Corporation', code: '100144' },
  { name: 'Thiruvananthapuram Municipal Corporation', code: '100145' },
  { name: 'Thrissur Municipal Corporation', code: '100146' },
  { name: 'Tiruchirappalli Municipal Corporation', code: '100147' },
  { name: 'Tiruppur Municipal Corporation', code: '100148' },
  { name: 'Udaipur Municipal Corporation', code: '100149' },
  { name: 'Vadodara Municipal Corporation', code: '100150' },
  { name: 'Varanasi Municipal Corporation', code: '100151' },
  { name: 'Vasai-Virar Municipal Corporation', code: '100152' },
  { name: 'Vijayawada Municipal Corporation', code: '100153' },
  { name: 'Visakhapatnam Municipal Corporation', code: '100154' },
  { name: 'Warangal Municipal Corporation', code: '100155' }
]

// Helper functions
export const getMunicipalCodeByName = (name) => {
  const corp = municipalCorporations.find(corp => corp.name === name)
  return corp ? corp.code : null
}

export const getMunicipalNameByCode = (code) => {
  const corp = municipalCorporations.find(corp => corp.code === code)
  return corp ? corp.name : null
}

export const getMunicipalCorporationByCode = (code) => {
  return municipalCorporations.find(corp => corp.code === code) || null
}

export const getMunicipalCorporationByName = (name) => {
  return municipalCorporations.find(corp => corp.name === name) || null
}

export const isValidMunicipalCode = (code) => {
  return municipalCorporations.some(corp => corp.code === code)
}

export const getMunicipalCorporationNames = () => {
  return municipalCorporations.map(corp => corp.name)
}

export const getMunicipalCorporationCodes = () => {
  return municipalCorporations.map(corp => corp.code)
}

// Additional validation and utility functions
export const validateMunicipalCodeAndName = (code, name) => {
  const corpByCode = getMunicipalCorporationByCode(code)
  const corpByName = getMunicipalCorporationByName(name)
  
  if (!corpByCode && !corpByName) {
    return { valid: false, error: 'Neither code nor name found' }
  }
  
  if (corpByCode && corpByName) {
    if (corpByCode.code === corpByName.code) {
      return { valid: true, data: corpByCode }
    } else {
      return { valid: false, error: 'Code and name do not match' }
    }
  }
  
  return { valid: true, data: corpByCode || corpByName }
}

// Get all municipal corporations with their details
export const getAllMunicipalCorporations = () => {
  return municipalCorporations.map(corp => ({
    ...corp,
    state: getStateFromName(corp.name),
    region: getRegionFromName(corp.name)
  }))
}

// Helper function to get state from municipal corporation name
const getStateFromName = (name) => {
  const stateMap = {
    'Maharashtra': ['Mumbai', 'Pune', 'Nagpur', 'Nashik', 'Aurangabad', 'Solapur', 'Thane', 'Navi Mumbai', 'Mira-Bhayandar', 'Vasai-Virar', 'Pimpri-Chinchwad', 'Kolhapur', 'Jalgaon', 'Amravati', 'Ahmednagar', 'Dhule'],
    'Karnataka': ['Bangalore', 'Mysore', 'Mangalore', 'Hubli-Dharwad', 'Belagavi', 'Davangere', 'Ballari', 'Hospet'],
    'Tamil Nadu': ['Chennai', 'Coimbatore', 'Madurai', 'Salem', 'Tiruchirappalli', 'Tiruppur', 'Cuddalore', 'Dindigul', 'Erode', 'Kollam', 'Thiruvananthapuram', 'Thrissur', 'Kozhikode'],
    'Telangana': ['Hyderabad', 'Warangal'],
    'Andhra Pradesh': ['Visakhapatnam', 'Vijayawada', 'Kakinada', 'Nellore', 'Kurnool', 'Anantapur', 'Eluru'],
    'Gujarat': ['Ahmedabad', 'Surat', 'Vadodara', 'Rajkot', 'Jamnagar', 'Bhavnagar', 'Gandhinagar', 'Bhiwandi-Nizampur'],
    'Uttar Pradesh': ['Lucknow', 'Kanpur', 'Varanasi', 'Agra', 'Ghaziabad', 'Noida', 'Greater Noida', 'Bareilly', 'Aligarh', 'Jhansi', 'Gorakhpur', 'Ayodhya', 'Firozabad'],
    'Delhi': ['Delhi'],
    'West Bengal': ['Kolkata', 'Siliguri', 'Haldia', 'Chandernagore', 'Bidhannagar'],
    'Rajasthan': ['Jaipur', 'Jodhpur', 'Bikaner', 'Udaipur', 'Ajmer', 'Alwar', 'Bharatpur', 'Bathinda', 'Batala'],
    'Punjab': ['Amritsar', 'Ludhiana', 'Jalandhar', 'Patiala', 'Bathinda', 'Batala'],
    'Haryana': ['Gurugram', 'Faridabad', 'Ambala', 'Karnal', 'Yamunanagar'],
    'Madhya Pradesh': ['Bhopal', 'Indore', 'Jabalpur', 'Gwalior', 'Ujjain', 'Bhind', 'Betul', 'Chhindwara', 'Burhanpur', 'Dewas', 'Dhamtari'],
    'Bihar': ['Patna', 'Gaya', 'Bhagalpur', 'Darbhanga', 'Bihar Sharif', 'Arrah', 'Begusarai', 'Giridih', 'Hazaribagh'],
    'Odisha': ['Bhubaneswar', 'Cuttack', 'Berhampur', 'Puri', 'Rourkela'],
    'Jharkhand': ['Ranchi', 'Jamshedpur', 'Dhanbad', 'Bokaro', 'Hazaribagh', 'Giridih'],
    'Assam': ['Guwahati'],
    'Uttarakhand': ['Dehradun', 'Haridwar', 'Shimla'],
    'Himachal Pradesh': ['Shimla', 'Dharamshala'],
    'Jammu & Kashmir': ['Srinagar', 'Jammu'],
    'Chhattisgarh': ['Raipur', 'Bhilai', 'Bhilai Charoda', 'Durg', 'Bilaspur', 'Korba', 'Rajnandgaon'],
    'Goa': ['Panaji'],
    'Kerala': ['Kochi', 'Thiruvananthapuram', 'Kozhikode', 'Thrissur', 'Kollam'],
    'Manipur': ['Imphal'],
    'Mizoram': ['Aizawl'],
    'Nagaland': ['Dimapur'],
    'Tripura': ['Agartala'],
    'Sikkim': ['Gangtok'],
    'Arunachal Pradesh': ['Itanagar'],
    'Meghalaya': ['Shillong']
  }
  
  for (const [state, cities] of Object.entries(stateMap)) {
    if (cities.some(city => name.includes(city))) {
      return state
    }
  }
  
  return 'Other'
}

// Helper function to get region from municipal corporation name
const getRegionFromName = (name) => {
  const northStates = ['Delhi', 'Uttar Pradesh', 'Punjab', 'Haryana', 'Himachal Pradesh', 'Uttarakhand', 'Jammu & Kashmir']
  const southStates = ['Karnataka', 'Tamil Nadu', 'Andhra Pradesh', 'Telangana', 'Kerala']
  const eastStates = ['West Bengal', 'Bihar', 'Odisha', 'Jharkhand', 'Assam', 'Manipur', 'Mizoram', 'Nagaland', 'Tripura', 'Sikkim', 'Arunachal Pradesh', 'Meghalaya']
  const westStates = ['Maharashtra', 'Gujarat', 'Rajasthan', 'Madhya Pradesh', 'Chhattisgarh', 'Goa']
  
  const state = getStateFromName(name)
  
  if (northStates.includes(state)) return 'North'
  if (southStates.includes(state)) return 'South'
  if (eastStates.includes(state)) return 'East'
  if (westStates.includes(state)) return 'West'
  
  return 'Central'
}

// Test function to verify all mappings work correctly
export const testMunicipalCorporationMappings = () => {
  const results = []
  
  municipalCorporations.forEach(corp => {
    const codeByName = getMunicipalCodeByName(corp.name)
    const nameByCode = getMunicipalNameByCode(corp.code)
    
    const isValid = codeByName === corp.code && nameByCode === corp.name
    
    results.push({
      original: corp,
      codeByName,
      nameByCode,
      isValid,
      error: isValid ? null : `Mismatch: codeByName=${codeByName}, nameByCode=${nameByCode}`
    })
  })
  
  const allValid = results.every(r => r.isValid)
  const errors = results.filter(r => !r.isValid)
  
  return {
    total: results.length,
    valid: results.filter(r => r.isValid).length,
    invalid: errors.length,
    allValid,
    errors,
    results
  }
}

// Simple test function for browser console
export const testAllMappings = () => {
  console.log('🧪 Testing all municipal corporation mappings...')
  
  const testResults = testMunicipalCorporationMappings()
  
  if (testResults.allValid) {
    console.log('✅ All mappings are working correctly!')
    console.log(`📊 Total: ${testResults.total}, Valid: ${testResults.valid}, Invalid: ${testResults.invalid}`)
  } else {
    console.log('❌ Some mappings have errors:')
    testResults.errors.forEach(error => {
      console.log(`   - ${error.original.name} (${error.original.code}): ${error.error}`)
    })
  }
  
  // Test specific examples
  console.log('\n🔍 Testing specific examples:')
  console.log('Aurangabad (100021):', getMunicipalNameByCode('100021'))
  console.log('Pune (100133):', getMunicipalNameByCode('100133'))
  console.log('Mumbai (100049):', getMunicipalNameByCode('100049'))
  console.log('Delhi (100049):', getMunicipalNameByCode('100049'))
  
  return testResults
}

// Make test function available globally for browser console testing
if (typeof window !== 'undefined') {
  window.testMunicipalMappings = testAllMappings
}

// Get municipal corporations by state
export const getMunicipalCorporationsByState = (state) => {
  return municipalCorporations.filter(corp => getStateFromName(corp.name) === state)
}

// Get municipal corporations by region
export const getMunicipalCorporationsByRegion = (region) => {
  return municipalCorporations.filter(corp => getRegionFromName(corp.name) === region)
}

// Search municipal corporations by partial name or code
export const searchMunicipalCorporations = (query) => {
  const searchTerm = query.toLowerCase()
  return municipalCorporations.filter(corp => 
    corp.name.toLowerCase().includes(searchTerm) || 
    corp.code.includes(searchTerm)
  )
}
